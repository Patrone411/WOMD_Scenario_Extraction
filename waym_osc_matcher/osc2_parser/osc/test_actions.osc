#import chopped_standard.osc
import standard.osc

scenario top:
    path: path                      # A path in the map
    path.min_lanes(2)         # Path should have at least two lanes

    ego_vehicle: vehicle
    second_car: vehicle
    npc: person               # The other car

    ego_start_speed: speed = 30kph
    drive_duration: time = 12s
    do serial:
        get_ahead: parallel(duration: 15s):
            ego_vehicle.drive(drive_duration) with:
                speed(ego_start_speed)
                position([10m..20m], ahead_of: npc, at: start)
                lateral(2m, side: left, side_of: npc, at: start)

            ego_vehicle.drive(drive_duration) with:
                acceleration(5kphps)
            
            ego_vehicle.move() with:
                position(10m, ahead_of: npc, at: start)
                lateral(2m, side: left, side_of: npc, at: start)
                speed(10kph, at: end)

            # Move to position in front of my_car and stop, with duration 3 seconds
            ego_vehicle.drive(duration: 3s) with:
                speed(0kph, at: end)
                speed(0kph)
                position(3m, ahead_of: second_car, at: end)
                lateral(0.2m, side_of: second_car, at: end)
                change_speed(20kph)
                change_speed([10kph..20kph])
                speed(same_as: second_car)
                keep_speed()
                acceleration(5kphps)
                #yaw([2s..3deg]) # [Error] wrong unit in the range
                #yaw(2m)
                yaw(2deg)
                distance([30m..50m])
                lane(1)
                lane(1, from: left)
                lane(side_of: second_car, side: left)
                lane(2,side_of: second_car, side: left)
                change_lane(side: left)
                change_lane([1..3])
            npc.walk(drive_duration)


